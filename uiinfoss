#!/bin/bash

# Run UAPI command and store output
OUTPUT=$(uapi Variables get_user_information)

# Check if the command was successful
if [ $? -ne 0 ]; then
    echo -e "\e[31mError: Unable to fetch user information.\e[0m"
    exit 1
fi

# Extract required details using grep and awk
USER=$(echo "$OUTPUT" | grep -Po '(?<=user: ).*')
DOMAIN=$(echo "$OUTPUT" | grep -Po '(?<=domain: ).*')
CONTACT_EMAIL=$(echo "$OUTPUT" | grep -Po '(?<=contact_email: ).*')
IP=$(echo "$OUTPUT" | grep -Po '(?<=ip: ).*')
PLAN=$(echo "$OUTPUT" | grep -Po '(?<=plan: ).*')
CREATED_DATE=$(echo "$OUTPUT" | grep -Po '(?<=created: ).*')

# Convert UNIX timestamp to readable format
CREATED_DATE=$(date -d @${CREATED_DATE} 2>/dev/null || date -r ${CREATED_DATE})

# Print formatted output with colors
clear
echo -e "\e[1;34m============================="
echo -e "   User Information Report"
echo -e "=============================\e[0m"
echo -e "\e[1;33mUser:           \e[0m$USER"
echo -e "\e[1;33mDomain:         \e[0m$DOMAIN"
echo -e "\e[1;33mContact Email:  \e[0m$CONTACT_EMAIL"
echo -e "\e[1;33mServer IP:      \e[0m$IP"
echo -e "\e[1;33mHosting Plan:   \e[0m$PLAN"
echo -e "\e[1;33mAccount Created:\e[0m $CREATED_DATE"
echo -e "\e[1;34m============================="
