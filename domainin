#!/bin/bash

# Define Colors
RED="\033[1;31m"
GREEN="\033[1;32m"
YELLOW="\033[1;33m"
BLUE="\033[1;34m"
CYAN="\033[1;36m"
WHITE="\033[1;37m"
RESET="\033[0m"

# Run the command and store output
OUTPUT=$(uapi DomainInfo domains_data)

# Print Table Header
echo -e "${WHITE}-------------------------------------------------------------${RESET}"
echo -e "| ${CYAN}Domain Name${RESET}         | ${CYAN}Document Root${RESET}              | ${CYAN}Type${RESET}         |"
echo -e "${WHITE}-------------------------------------------------------------${RESET}"

# Counters
total=0
addon_count=0
subdomain_count=0
parked_count=0
primary_count=0

while read -r line; do
    if [[ $line =~ "domain:" ]]; then
        domain=$(echo "$line" | awk '{print $2}')
        total=$((total+1))
    elif [[ $line =~ "documentroot:" ]]; then
        documentroot=$(echo "$line" | awk '{print $2}')
    elif [[ $line =~ "type:" ]]; then
        type=$(echo "$line" | awk '{print $2}')

        # Count types
        case $type in
            "addon_domain") addon_count=$((addon_count+1)); type_color=$YELLOW ;;
            "sub_domain") subdomain_count=$((subdomain_count+1)); type_color=$BLUE ;;
            "parked_domain") parked_count=$((parked_count+1)); type_color=$RED ;;
            "main_domain") primary_count=$((primary_count+1)); type_color=$GREEN ;;
        esac

        # Print the formatted table row with colors
        printf "| %-18s | %-25s | ${type_color}%-12s${RESET} |\n" "$domain" "$documentroot" "$type"
    fi
done <<< "$OUTPUT"

# Print Table Footer
echo -e "${WHITE}-------------------------------------------------------------${RESET}"

# Print Summary with Colors
echo -e "${CYAN}Total Domains:${RESET} ${WHITE}$total${RESET}"
echo -e "${GREEN}Primary Domains:${RESET} ${WHITE}$primary_count${RESET}"
echo -e "${YELLOW}Addon Domains:${RESET} ${WHITE}$addon_count${RESET}"
echo -e "${BLUE}Subdomains:${RESET} ${WHITE}$subdomain_count${RESET}"
echo -e "${RED}Parked Domains:${RESET} ${WHITE}$parked_count${RESET}"
